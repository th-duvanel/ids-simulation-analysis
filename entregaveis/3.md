# Metodologia da Pesquisa

Esta seção detalha o plano experimental projetado para responder à pergunta de pesquisa sobre o impacto da saturação de pacotes na eficácia de um NIDS.

### 1. Tipo de Pesquisa

A pesquisa é de natureza **experimental e quantitativa**. Será utilizado um ambiente de simulação de redes (NS3) para executar uma série de experimentos controlados. O objetivo é coletar dados numéricos para estabelecer correlações estatísticas entre as variáveis da rede (carga de tráfego) e as métricas de desempenho do NIDS (descarte de pacotes e detecção de ataques).

### 2. Ambiente e Instrumento de Simulação

* **Software:** Simulador NS3 (versão 3.46.1).
* **Instrumento:** Um script de simulação C++ customizado (`simulacao.cc`).
* **Topologia:** A simulação implementa uma topologia "estrela" (ou "dumbbell") com um gargalo central:
    * **Clientes (Spokes):** 6 nós clientes, divididos em:
        * 5 Nós de "Tráfego de Fundo": Geram tráfego UDP de inundação (o "ruído").
        * 1 Nó "Atacante": Gera um fluxo UDP de baixa taxa (o "sinal" ou ataque).
    * **Roteador/NIDS (Hub):** 1 nó central por onde todo o tráfego deve passar.
    * **Servidor (Destino):** 1 nó servidor que atua como destino final para todo o tráfego.

### 3. Modelagem do Gargalo (NIDS)

O NIDS não é modelado como uma aplicação, mas sim como uma restrição de infraestrutura no nó `Roteador/NIDS`.

* **Gargalo de $pps$:** O gargalo é simulado nas filas de entrada (`Queue`) dos dispositivos de rede (`PointToPointNetDevice`) do roteador.
* **Mecanismo:** Utilizamos uma `ns3::DropTailQueue` e definimos seu atributo `MaxSize` para um número finito de pacotes (ex: `"100p"`). Isso simula um NIDS com um buffer de processamento limitado. A taxa de dados do link (`DataRate`) é mantida alta (1 Gbps) para garantir que o gargalo seja a contagem de pacotes ($pps$), e não a largura de banda ($bps$).

### 4. Instrumentos de Coleta de Dados

A coleta de dados é realizada através do sistema de *callbacks* (`TraceConnect`) do NS3, anexados diretamente às filas de entrada do NIDS:

1.  **`TraceConnect("Enqueue")`:** Dispara a cada tentativa de enfileirar um pacote. Usado para contar `g_totalPacotesFila` (denominador da VD1).
2.  **`TraceConnect("Drop")`:** Dispara a cada pacote descartado por fila cheia. Usado para contar `g_totalDescartes` (numerador da VD1).
3.  **Inspeção de Pacotes Descartados:** Dentro do *callback* "Drop", o pacote é inspecionado. Se for um pacote de "ataque" (identificado pela porta UDP de destino), o contador `g_descartesAtaque` é incrementado (numerador da VD2).

### 5. Definição das Variáveis

#### Variáveis Independentes (VIs)
*Parâmetros que o experimento manipula:*
1.  **`taxa_pps_total`:** A taxa de pacotes de fundo agregada (VI primária), varrida de 5.000 a 50.000 $pps$.
2.  **`tamanho_pacote_fundo`:** O tamanho dos pacotes de fundo (128 bytes vs. 1400 bytes).
3.  **`tamanho_fila_nids`:** A capacidade da fila do NIDS (50p, 100p, 250p).

#### Variáveis Dependentes (VDs)
*Métricas de resultado que o experimento mede:*
1.  **`taxa_descarte_geral` (%):** `(g_totalDescartes / g_totalPacotesFila)`. Mede a **saturação** do NIDS.
2.  **`taxa_deteccao_ataque` (%):** `((TotalAtaquesEnviados - g_descartesAtaque) / TotalAtaquesEnviados)`. Mede a **eficácia** de segurança do NIDS, assumindo que um pacote não descartado é um pacote "visto" ou "detectado".

### 6. Plano Experimental (Análise Paramétrica)

Para gerar dados suficientes para um artigo, dois estudos principais serão conduzidos, cada um comparado a um cenário de controle.

#### Cenário de Controle (Baseline)
Para todos os estudos, um cenário "Baseline" será executado. Este cenário utiliza uma fila funcionalmente infinita (`MaxSize = "1000000p"`). O resultado esperado é $0\%$ de descarte e $100\%$ de detecção, servindo como a linha de base "perfeita" para comparação.

#### Estudo 1: Análise da Natureza da Carga (PPS vs. BPS)
* **Pergunta:** O desempenho do NIDS é degradado pela taxa de bits ($bps$) ou pela taxa de pacotes ($pps$)?
* **Variáveis Fixas:** `tamanho_fila_nids = "100p"`.
* **VI Primária:** `taxa_pps_total` (varrida de 5k a 50k $pps$).
* **Grupos de Comparação:**
    * **Cenário A (Alto-PPS):** `tamanho_pacote_fundo = 128 bytes`.
    * **Cenário B (Alto-BPS):** `tamanho_pacote_fundo = 1400 bytes`.
* **VD Principal de Análise:** `taxa_descarte_geral`.

#### Estudo 2: Análise de Resiliência do NIDS
* **Pergunta:** Como a capacidade de buffer (tamanho da fila) do NIDS impacta sua capacidade de detectar ataques sob saturação?
* **Variáveis Fixas:** `tamanho_pacote_fundo = 128 bytes` (pior caso identificado no Estudo 1).
* **VI Primária:** `taxa_pps_total` (varrida de 5k a 50k $pps$).
* **Grupos de Comparação:**
    * **Cenário A (NIDS Barato):** `tamanho_fila_nids = "50p"`.
    * **Cenário B (NIDS Padrão):** `tamanho_fila_nids = "100p"`.
    * **Cenário C (NIDS Caro):** `tamanho_fila_nids = "250p"`.
* **VD Principal de Análise:** `taxa_deteccao_ataque`.

### 7. Análise dos Dados

Os dados brutos gerados pelo `run.sh` (múltiplas rodadas com sementes diferentes) serão agregados (média) para cada ponto de dados. Dois gráficos principais serão gerados para o artigo:

1.  **Gráfico (Estudo 1):** Plotará `taxa_pps_total` (Eixo X) vs. `taxa_descarte_geral` (Eixo Y), comparando as linhas "Alto-PPS", "Alto-BPS" e "Baseline".
2.  **Gráfico (Estudo 2):** Plotará `taxa_pps_total` (Eixo X) vs. `taxa_deteccao_ataque` (Eixo Y), comparando as linhas "Fila=50", "Fila=100", "Fila=250" e "Baseline".